{"version":3,"file":"forum.js","mappings":"qBACA,WACE,aAIA,SAASA,EAAQC,GACf,IAAIC,EAAKC,SAASC,cAAc,cAAgBH,EAAO,MACvD,OAAOC,EAAKA,EAAGG,aAAa,WAAa,IAC3C,CAOA,SAASC,IACP,IAAIC,EAAIC,OAAOC,SAASC,SAASC,MAAM,mBACvC,OAAOJ,EAAIK,mBAAmBL,EAAE,IAAM,IACxC,CAiDAM,eAAeC,IACb,IAAIC,EAAOT,IAAsB,GAAKS,EAAL,CACjC,IAAIC,QAnBNH,eAA+BE,GAC7B,IACE,IAAIE,QAAUC,MAAM,cAAgBC,mBAAmBJ,GAAO,CAAEK,QAAS,CAAE,OAAU,4BAA8BC,YAAa,gBAChI,OAAKJ,EAAEK,SACML,EAAEM,OADG,IAEpB,CAAE,MAAOC,GAAK,OAAO,IAAM,CAC7B,CAamBC,CAAgBV,GAAO,GAAKC,GAASA,EAAKU,KAAnB,CAExC,IAAIC,EAAQX,EAAKU,KAAKE,YAAc,CAAC,EACjCC,EAAQrB,OAAOsB,OAAO,uCAAwCH,EAAME,OAAS,IAAIE,YACrF,GAAc,OAAVF,EAEJ,IADAA,GAASA,GAAS,IAAIG,QACZC,OAAS,IAAOC,MAAM,8CAAhC,CAEA,IAAIC,EAAQ3B,OAAOsB,OAAO,sBAAuBH,EAAMS,mBAAqB,IAAIL,YAChF,GAAc,OAAVI,EAAJ,CAA4BA,GAASA,GAAS,IAAIH,OAElD,IAAIK,EAtEN,WACE,IAAM,GAAI7B,OAAO8B,KAAO9B,OAAO8B,IAAIC,SAAW/B,OAAO8B,IAAIC,QAAQC,UAAW,OAAOhC,OAAO8B,IAAIC,QAAQC,SAAW,CAAE,MAAOhB,GAAI,CAC9H,OAAOxB,EAAQ,eAAiBA,EAAQ,SAAW,IACrD,CAmEayC,GACPC,QAvBN7B,eAAyB8B,EAAIhB,EAAOU,GAClC,IAAIjB,EAAU,CAAE,OAAU,2BAA4B,eAAgB,4BAEtE,OADIiB,IAAMjB,EAAQ,gBAAkBiB,GAC7BnB,MAAM,cAAgBC,mBAAmByB,OAAOD,IAAM,CAC3DE,OAAQ,QAASxB,YAAa,cAAeD,UAC7C0B,KAAMC,KAAKC,UAAU,CAAEtB,KAAM,CAAEuB,KAAM,QAASN,GAAIC,OAAOD,GAAKf,WAAYD,MAE9E,CAgBkBuB,CAAUlC,EAAKU,KAAKiB,GAAI,CAAEd,QAAOO,kBAAmBD,GAASE,GAC7E,GAAIK,GAAOA,EAAIpB,GAAId,OAAOC,SAAS0C,aAC9B,CACH,IAAIC,EAAM,gBACV,IAAMA,GAAO,WAAcV,EAAIW,MAAS,CAAE,MAAM7B,GAAI,CACpDU,MAAMkB,EACR,CAT0B,CAHyD,CANZ,CADrB,CAoBpD,CAEA,SAASE,IAnDT,IACMC,EACAC,EArBoClD,MAEJH,SAASsD,eADvB,4BAmBlBF,EAPN,WAEE,IADA,IAAIG,EAAO,CAAC,uBAAuB,YAAY,mBAAmB,YAAY,YAAY,uBAAuB,2BACxGC,EAAE,EAAEA,EAAED,EAAKzB,OAAO0B,IAAK,CAAE,IAAIzD,EAAKC,SAASC,cAAcsD,EAAKC,IAAK,GAAIzD,EAAI,OAAOA,CAAI,CAC/F,OAAO,IACT,CAGkB0D,GACZJ,EAjBN,WACE,IAAIA,EAAMrD,SAAS0D,cAAc,UAKjC,OAJAL,EAAIb,GALkB,yBAMtBa,EAAIP,KAAO,SACXO,EAAIM,YAAc,oBAClBN,EAAIO,MAAMC,QAAU,gKACbR,CACT,CAUYS,GACNV,EAAWA,EAAUW,YAAYV,IAEnCA,EAAIO,MAAMI,SAAW,QAASX,EAAIO,MAAMK,OAAS,OAAQZ,EAAIO,MAAMM,MAAQ,OAAQb,EAAIO,MAAMO,OAAS,aACtGnE,SAAS2C,KAAKoB,YAAYV,IAErBA,GA8CHe,iBAAiB,QAASzD,EAChC,CAEA,SAAS0D,IACP,IACY,IAAIC,iBAAiB,WAAcnB,GAAgB,GACzDoB,QAAQvE,SAASwE,iBAAmBxE,SAAS2C,KAAM,CAAE8B,WAAW,EAAMC,SAAS,GACrF,CAAE,MAAOrD,GAAI,CACf,CAG4B,YAAxBrB,SAAS2E,WACX3E,SAASoE,iBAAiB,mBAAoB,WAAcjB,IAAgBkB,GAAiB,IAE7FlB,IAAgBkB,IAEnB,CA7GD,GAgHAO,EAAOC,QAAU,CAAEC,OAAQ,G,GChHvBC,EAA2B,CAAC,ECE5BC,EDCJ,SAASC,EAAoBC,GAE5B,IAAIC,EAAeJ,EAAyBG,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaN,QAGrB,IAAID,EAASG,EAAyBG,GAAY,CAGjDL,QAAS,CAAC,GAOX,OAHAQ,EAAoBH,GAAUN,EAAQA,EAAOC,QAASI,GAG/CL,EAAOC,OACf,CCnB0BI,CAAoB,K","sources":["webpack://flarum-profile-title-and-description-build/./js/src/forum/index.js","webpack://flarum-profile-title-and-description-build/webpack/bootstrap","webpack://flarum-profile-title-and-description-build/webpack/startup"],"sourcesContent":["// Keep the DOMâ€‘only implementation. No direct compat dependency required.\n(function () {\n  'use strict';\n\n  var EXT_ID = 'kmcginley-1928-profile-title-and-description';\n\n  function getMeta(name) {\n    var el = document.querySelector('meta[name=\"' + name + '\"]');\n    return el ? el.getAttribute('content') : null;\n  }\n\n  function getCsrfToken() {\n    try { if (window.app && window.app.session && window.app.session.csrfToken) return window.app.session.csrfToken; } catch (_) {}\n    return getMeta('csrf-token') || getMeta('csrf') || null;\n  }\n\n  function currentProfileSlug() {\n    var m = window.location.pathname.match(/\\/u\\/([^/?#]+)/i);\n    return m ? decodeURIComponent(m[1]) : null;\n  }\n\n  function isOnUserProfilePage() { return !!currentProfileSlug(); }\n  function key() { return 'kmcginley1928-ptad-btn'; }\n  function alreadyInjected() { return !!document.getElementById(key()); }\n\n  function createButton() {\n    var btn = document.createElement('button');\n    btn.id = key();\n    btn.type = 'button';\n    btn.textContent = 'Edit profile info';\n    btn.style.cssText = 'cursor:pointer;padding:6px 10px;font-size:14px;border-radius:4px;border:1px solid #0a7cff;background:#0a7cff;color:#fff;margin:8px 0 0 8px;white-space:nowrap';\n    return btn;\n  }\n\n  function findProfileHeaderContainer() {\n    var sels = ['.UserHero .container','.UserHero','.Hero .container','.UserCard','.UserPage','.UserPage .container','.App-content .container'];\n    for (var i=0;i<sels.length;i++) { var el = document.querySelector(sels[i]); if (el) return el; }\n    return null;\n  }\n\n  function injectButton() {\n    var container = findProfileHeaderContainer();\n    var btn = createButton();\n    if (container) container.appendChild(btn);\n    else {\n      btn.style.position = 'fixed'; btn.style.bottom = '16px'; btn.style.right = '16px'; btn.style.zIndex = '2147483647';\n      document.body.appendChild(btn);\n    }\n    return btn;\n  }\n\n  async function fetchUserBySlug(slug) {\n    try {\n      var r = await fetch('/api/users/' + encodeURIComponent(slug), { headers: { 'Accept': 'application/vnd.api+json' }, credentials: 'same-origin' });\n      if (!r.ok) return null;\n      return await r.json();\n    } catch (_) { return null; }\n  }\n\n  async function patchUser(id, attrs, csrf) {\n    var headers = { 'Accept': 'application/vnd.api+json', 'Content-Type': 'application/vnd.api+json' };\n    if (csrf) headers['X-CSRF-Token'] = csrf;\n    return fetch('/api/users/' + encodeURIComponent(String(id)), {\n      method: 'PATCH', credentials: 'same-origin', headers,\n      body: JSON.stringify({ data: { type: 'users', id: String(id), attributes: attrs } })\n    });\n  }\n\n  async function onEditClick() {\n    var slug = currentProfileSlug(); if (!slug) return;\n    var user = await fetchUserBySlug(slug); if (!user || !user.data) return;\n\n    var attrs = user.data.attributes || {};\n    var title = window.prompt('Profile title (max 250 characters):', (attrs.title || '').toString());\n    if (title === null) return;\n    title = (title || '').trim();\n    if (title.length > 250) { alert('Title must be 250 characters or fewer.'); return; }\n\n    var short = window.prompt('Short description:', (attrs.short_description || '').toString());\n    if (short === null) return; short = (short || '').trim();\n\n    var csrf = getCsrfToken();\n    var res = await patchUser(user.data.id, { title, short_description: short }, csrf);\n    if (res && res.ok) window.location.reload();\n    else {\n      var msg = 'Saving failed';\n      try { msg += ': ' + (await res.text()); } catch(_) {}\n      alert(msg);\n    }\n  }\n\n  function ensureButton() {\n    if (!isOnUserProfilePage() || alreadyInjected()) return;\n    var btn = injectButton();\n    btn.addEventListener('click', onEditClick);\n  }\n\n  function setupObserver() {\n    try {\n      var obs = new MutationObserver(function () { ensureButton(); });\n      obs.observe(document.documentElement || document.body, { childList: true, subtree: true });\n    } catch (_) {}\n  }\n\n  // Run with or without app\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function () { ensureButton(); setupObserver(); });\n  } else {\n    ensureButton(); setupObserver();\n  }\n})();\n\n// Export a harmless object so Flarum assigns a module, not undefined.\nmodule.exports = { extend: [] };","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(214);\n"],"names":["getMeta","name","el","document","querySelector","getAttribute","currentProfileSlug","m","window","location","pathname","match","decodeURIComponent","async","onEditClick","slug","user","r","fetch","encodeURIComponent","headers","credentials","ok","json","_","fetchUserBySlug","data","attrs","attributes","title","prompt","toString","trim","length","alert","short","short_description","csrf","app","session","csrfToken","getCsrfToken","res","id","String","method","body","JSON","stringify","type","patchUser","reload","msg","text","ensureButton","container","btn","getElementById","sels","i","findProfileHeaderContainer","createElement","textContent","style","cssText","createButton","appendChild","position","bottom","right","zIndex","addEventListener","setupObserver","MutationObserver","observe","documentElement","childList","subtree","readyState","module","exports","extend","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__"],"sourceRoot":""}